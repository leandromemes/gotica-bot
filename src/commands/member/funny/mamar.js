module.exports = {
  name: "mamar",
  description: "Sorteia uma pessoa para mamar a administra√ß√£o do grupo.",
  commands: ["mamar"],
  usage: "!mamar",

  handle: async ({ webMessage, sendReply, socket }) => {
    try {
      const groupId = webMessage.key.remoteJid;
      const grupoInfo = await socket.groupMetadata(groupId);
      
      const membros = grupoInfo.participants
        .filter((m) => !m.id.endsWith("g.us") && !m.id.includes("broadcast"))
        .map((m) => m.id);

      // Garante que haja pelo menos uma pessoa para sortear al√©m do bot
      if (membros.length < 1) {
        return await sendReply("‚ùå Poucos membros no grupo para sortear. Pelo menos 1 membro √© necess√°rio.");
      }

      // Sorteia um membro aleat√≥rio
      const sortudo = membros[Math.floor(Math.random() * membros.length)];

      const responseText = `‚ö†Ô∏èü´£ Aten√ß√£o, galera! O sortudo ou a sortuda de hoje que vai dar uma mamada na administra√ß√£o do grupo √©... @${sortudo.split("@")[0]}! üëÖüê∏üçÜ`;

      // Envia a mensagem com a men√ß√£o
      await socket.sendMessage(groupId, {
        text: responseText,
        mentions: [sortudo],
      });

    } catch (error) {
      console.error("Erro no comando !mamar:", error);
      return await sendReply("‚ùå Ocorreu um erro ao processar o comando. Tente novamente mais tarde.");
    }
  },
};